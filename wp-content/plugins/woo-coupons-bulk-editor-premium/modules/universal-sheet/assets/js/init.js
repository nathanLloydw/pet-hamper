function vgseColumnKeyToExportKey(e){if(vgse_editor_settings.export_keys_mapping&&vgse_editor_settings.export_keys_mapping[e])var t=vgse_editor_settings.export_keys_mapping[e];else t=e;return t}function vgse_reset_column_mapping(e){e.find("li.map-columns .map-template:not(.hidden)").toArray().forEach(function(e){var t=jQuery(e),a=t.find("select");a.val(a.data("original_selected_value")),t.removeClass("wpse-hidden")}),e.find("li.map-columns button.wpse-show-columns-again").addClass("wpse-hidden"),e.find("li.map-columns button.next-step").last().removeClass("wpse-hidden"),e.find("li.map-columns .wpse-all-columns-ignored-message").remove()}function vgsePrepareColumnHeaderForMapping(e,t){if(-1<["ID","id","record_id"].indexOf(e))var a="ID";else a=e;var o=a.replace(/[0-9]+/g,"");if(vgse_editor_settings.post_type===vgse_editor_settings.woocommerce_product_post_type_key&&vgse_editor_settings.wc_repeatable_columns){var n=t?vgse_editor_settings.wc_repeatable_columns_english:vgse_editor_settings.wc_repeatable_columns;jQuery.each(n,function(e,t){e.replace(/\%d/g,"").toLowerCase()===o.toLowerCase()&&(a=t)})}return a}function vgse_get_import_columns_mapping_status(e){var t=e.find("li.map-columns .map-template:not(.hidden)"),a=!0,o=!0;return t.toArray().forEach(function(e){var t=jQuery(e);t.hasClass("wpse-hidden")||(o=!1),""!==t.find("select").val()&&(a=!1)}),{all_columns_are_being_ignored:a,all_columns_are_hidden:o}}function vgse_column_mapping_step_is_valid(e,t){if(!e.find(".step.current").hasClass("map-columns"))return!0;var a=e.find("li.map-columns .map-template:not(.hidden)");!!t&&(t.parent().hasClass("import-auto-map-notice")&&t.hasClass("next-step"))&&vgse_reset_column_mapping(e);var o=jQuery(document.createElement("p")).attr({class:"wpse-all-columns-ignored-message"}).text(vgse_editor_settings.texts.import_all_columns_ignored),n=e.find("li.map-columns button.wpse-show-columns-again"),r=e.find("li.map-columns button.next-step"),i=0<e.find("li.map-columns .wpse-all-columns-ignored-message").length;if(n.length<=0){n=jQuery(document.createElement("button")).attr({class:"wpse-show-columns-again wpse-hidden button button-primary button-primario"}).text(vgse_editor_settings.texts.import_show_all_columns_rows);r.last().after(n)}var s=vgse_get_import_columns_mapping_status(e);return s.all_columns_are_being_ignored?(i||a.last().after(o),s.all_columns_are_hidden&&(r.last().addClass("wpse-hidden"),n.removeClass("wpse-hidden")),!1):(e.find("li.map-columns .wpse-all-columns-ignored-message").remove(),!0)}jQuery(document).ready(function(){if(!jQuery(".import-csv-modal").length)return!0;jQuery(".import-csv-modal .remodal-confirm").hide();var v=jQuery(".import-csv-form");function r(){var e=v.find(".step.current"),t=v.find(".step.current").prev(".step");e.slideToggle(),e.removeClass("current"),t.show(),t.addClass("current")}v.on("click",".map-columns .wpse-show-columns-again",function(e){e.preventDefault(),vgse_reset_column_mapping(v)}),v.on("click",".map-columns .wpse-ignore-column-cross",function(){jQuery;var e=jQuery(this).parent();e.addClass("wpse-hidden"),e.find("select").val(""),vgse_column_mapping_step_is_valid(v)}),v.find(".import-column-bulk-actions select").on("change",function(e){"unselect"===jQuery(this).val()&&jQuery(".map-columns .map-template select").val("")}),v.find(".toggle-advanced-options").on("change",function(e){jQuery(this).parent().next(".advanced-options").slideToggle()}),v.find(".existing-check-csv-field").on("change",function(e){var t=jQuery(this).val();if(t){var a=v.find(".map-columns .csv-column-name-value").filter(function(){return jQuery(this).val()===t}).parent().find("select").val();a?v.find(".wp-field-requires-ignored-column").hide():(v.find(".wp-field-requires-ignored-column").show(),jQuery(this).val("")),jQuery(this).parent(".field-wrapper").next(".field-wrapper").find("option").filter(function(){return jQuery(this).val()===a||jQuery(this).text()===t||"record_id"===t&&"ID"===jQuery(this).text()}).prop("selected",!0).trigger("change")}}),v.find('[name="writing_type"]').on("change",function(e){jQuery(this).val()&&"all_new"!==jQuery(this).val()?v.find(".field-find-existing-columns").show():v.find(".field-find-existing-columns").hide()}),v.find(".data-input,.step").hide(),v.find(".step").first().show(),v.find(".source").on("change",function(e){var t=jQuery(this).val();if(v.find(".data-input").hide(),"csv_upload"===t)v.find(".data-input.csv-upload").show();else if("csv_url"===t)v.find(".data-input.csv-url").show();else if("server_file"===t)v.find(".data-input.server-file").show();else if("paste"===t){v.find(".data-input.paste").show(),window.importHOT&&window.importHOT.destroy();var a={minSpareRows:4,wordWrap:!0,allowInsertRow:!0,columnSorting:!0,colHeaders:!1,width:v.width(),height:300},o=document.getElementById("handsontable-paste");window.importHOT=new Handsontable(o,a)}}),v.on("click",".next-step",function(e){if(e.preventDefault(),vgse_column_mapping_step_is_valid(v,jQuery(this))){!function(){var e=v.find(".step.current"),t=v.find(".step.current").next(".step");e.slideToggle(),e.removeClass("current"),t.show(),t.addClass("current")}();var t=v.find(".step.current");if(t.hasClass("preview-step")&&window.vgseImportData&&window.vgseImportData.success){window.importPreviewHOT&&window.importPreviewHOT.destroy();var a={data:window.vgseImportData.data.firstRows,minSpareRows:1,wordWrap:!0,allowInsertRow:!0,columnSorting:!0,colHeaders:window.vgseImportData.data.rowHeaders,width:v.width(),height:170},o=document.getElementById("hot-preview");window.importPreviewHOT=new Handsontable(o,a),jQuery(".import-csv-modal .remodal-confirm").show(),vgseAllowToClosePageWithoutWarning(!0)}t.hasClass("write-type")}}),v.on("click",".prev-step",function(e){e.preventDefault(),r()}),v.find(".vgse-upload-csv-file").on("click",function(e){e.preventDefault();var t=jQuery(this),o=t.parents(".data-input");loading_ajax({estado:!0});var a={data:{action:"vgse_upload_file_for_import",data_type:t.data("type"),vgse_plain_mode:"yes",nonce:jQuery("#vgse-wrapper").data("nonce"),separator:o.parents(".step").find(".separator").val(),decode_quotes:o.parents(".step").find(".decode-quotes").is(":checked")?"on":"",post_type:jQuery("#post-data").data("post-type")},type:"POST",url:ajaxurl};if("local"===t.data("type")){var n=new FormData;n.append("action","vgse_upload_file_for_import"),n.append("data_type",t.data("type")),n.append("nonce",jQuery("#vgse-wrapper").data("nonce")),n.append("post_type",jQuery("#post-data").data("post-type")),n.append("separator",o.parents(".step").find(".separator").val()),n.append("decode_quotes",o.parents(".step").find(".decode-quotes").is(":checked")?"on":""),n.append("data",""),n.append("file",document.getElementById("vgse-import-local-file").files[0]),a.processData=!1,a.contentType=!1,a.data=n}else"url"===t.data("type")?a.data.data=o.find(".data").val():"server_file"===t.data("type")?a.data.data=o.find(".data").val():a.data.data=window.importHOT.getSourceData();jQuery.ajax(a).always(function(f){if(window.vgseImportData=f,loading_ajax({estado:!1}),f.success&&f.data.rowHeaders){v.find(".existing-check-csv-field").each(function(){jQuery(this).find("option:not(:eq(0))").remove()}),v.find(".import-file").val(f.data.fileName),v.find(".total-rows").val(f.data.totalRows);var e=f.data.rowHeaders;v.find(".map-template:not(.hidden)").remove(),v.find(".import-column-bulk-actions").val(""),jQuery.each(e,function(e,t){if(t){var a=v.find(".map-template.hidden").clone();a.removeClass("hidden"),a.find(".csv-column-name-text").text(t),a.find(".csv-column-name-example").append(vgseStripHtml(f.data.firstRows[0][t]).substring(0,100)),a.find(".csv-column-name-value").val(t);var o={},n={};a.find("select option").each(function(){n[jQuery(this).text().trim().toLowerCase()]=jQuery(this),o[jQuery(this).val().trim().toLowerCase()]=jQuery(this)});var r=vgsePrepareColumnHeaderForMapping(t),i=vgsePrepareColumnHeaderForMapping(f.data.translatedHeaders[e],!0),s=vgse_editor_settings.import_saved_column_mappings||vgse_editor_settings.import_saved_column_mappings[r]||vgse_editor_settings.import_saved_column_mappings[i],d=o[vgse_editor_settings.import_saved_column_mappings[r]]||o[vgse_editor_settings.import_saved_column_mappings[i]],l=null;if(s&&d)l=d;else{vgse_editor_settings.is_taxonomy&&"Full hierarchy"===r&&(i=r="Name");var p=r.trim().toLowerCase(),c=i.trim().toLowerCase(),u=null;n[p]&&(u=n[p]),n[c]&&(u=n[c]),o[p]&&(u=o[p]),o[c]&&(u=o[c]),l=u}if(l){l.prop("selected",!0);var m=l.parents("select");m.attr("data-selected",l.val()),!1===/^(meta|downloads|attributes):/.test(l.val())&&vgseLazySelect(m,"importWPColumns")}v.find(".map-template").last().after(a),l&&(/^(meta|downloads|attributes):/.test(l.val())&&l.parents("select").trigger("change"),l.closest("select").data("original_selected_value",l.val())),v.find(".existing-check-csv-field").append('<option value="'+t+'">'+t+"</option>")}});var t=v.find(".map-template:not(.hidden) select").filter(function(){return!jQuery(this).val()});1===e.length?v.find(".one-column-detected-tip").show():v.find(".one-column-detected-tip").hide(),t.length?(v.find(".import-column-list-headers, .import-column-bulk-actions, .remember-column-mapping").show(),v.find(".map-template:not(.hidden)").show(),v.find(".import-auto-map-notice").hide(),v.find(".map-columns .button-primario.next-step").show()):(v.find(".import-auto-map-notice").show(),v.find(".import-column-list-headers, .import-column-bulk-actions, .remember-column-mapping").hide(),v.find(".map-columns .button-primario.next-step").hide(),v.find(".import-auto-map-notice .import-map-select-columns").on("click",function(e){e.preventDefault(),v.find(".import-column-list-headers, .import-column-bulk-actions").show(),v.find(".map-template:not(.hidden)").show(),v.find(".map-columns .button-primario.next-step").show()}))}else{r();var a=void 0!==f.data.message?f.data.message:"Error";notification({mensaje:"Error",tipo:"error",tiempo:18e4}),o.parents(".step").find(".file-upload-error").remove(),o.parents(".step").find(".advanced-options").before('<div class="alert alert-red file-upload-error">'+a+"</div>")}})}),vgse_editor_settings.post_type===vgse_editor_settings.woocommerce_product_post_type_key&&jQuery("body").on("change",".map-template select",function(){var e=jQuery(this).val();if(e&&/^(meta|downloads|attributes):/.test(e))if("meta:"===jQuery(this).val()){jQuery(this).find("option:selected").attr("value",jQuery(this).parents(".map-template").find(".csv-column-name-text").text().replace("Meta: ","meta:"))}else{var t=jQuery(this).find("option:selected").attr("value").replace(/[0-9]/g,"");v.find('.map-template select option[value*="'+t+'"]:selected').each(function(e){jQuery(this).attr("value",t+e)})}});var p=jQuery(".import-csv-modal");jQuery(document).on("closed",".import-csv-modal",function(){v.show(),v.find(".step").removeClass("current").hide(),v.find(".step").first().addClass("current").show(),p.find(".import-step").hide(),p.find(".remodal-confirm").hide()}),v.append('<input type="hidden" name="wpse_source_suffix" value="'+(vgse_editor_settings.wpse_source_suffix||"")+'" />'),p.on("submit",function(e){if(p.find('[name="schedule_for_later"]').prop("checked"))return!0;e.preventDefault(),p.find(".import-step").show();var r=p.find(".import-response");r.empty(),p.find("#be-import-nanobar-container").remove(),r.before('<div id="be-import-nanobar-container" />');var t={classname:"be-progress-bar",target:document.getElementById("be-import-nanobar-container")},i=new Nanobar(t);i.go(1),v.hide(),p.find(".remodal-cancel").hide(),p.find(".view-log a").attr("href",""),p.find(".view-log").hide();var a=parseInt(v.find(".total-rows").val()),s={updated:0,created:0,processed:0},d=0;v.find(".existing-check-wp-field").val()&&v.find(".auto-retry-failed-batches").prop("checked",!0);var o=["import",vgseFormatDate(),jQuery("#post-data").data("post-type"),vgseGuidGenerator()].join("-");v.find('input[name="wpse_job_id"]').val(o);var l=parseInt(v.find("input.per-page").val()||vgse_editor_settings.save_posts_per_page);return window.beImportLoop=beAjaxLoop({totalCalls:Math.ceil(a/l),url:vgse_editor_settings.ajax_url,dataType:"json",method:"POST",data:v.serializeArray(),onSuccess:function(a,o){if(a.data.log_url&&p.find(".view-log a").attr("href",a.data.log_url),d=0,!a.success)return"string"==typeof a.data.row&&(a.data.message+=". Row: "+a.data.row+"<br>"+vgse_editor_settings.texts.import_data_issue_correct_restart),r.append("<p>"+a.data.message+"</p>"),r.scrollTop(r[0].scrollHeight),i.go(100),p.find("#be-import-nanobar-container").remove(),p.find(".remodal-cancel").show(),p.find(".view-log a").attr("href")&&p.find(".view-log").show(),p.find(".import-actions").hide(),!1;if(Array.isArray(o.data)){var n=!1;o.data.forEach(function(e,t){"file_position"===e.name&&(o.data[t].value=a.data.file_position,n=!0)}),n||o.data.push({name:"file_position",value:a.data.file_position})}else o.data.file_position=a.data.file_position;s.updated+=a.data.updated,s.created+=a.data.created,s.processed+=a.data.processed;var e=a.data.message.replace("{total_updated}",s.updated).replace("{total_created}",s.created);return o.totalCalls=Math.ceil(parseInt(a.data.total)/l),r.empty(),r.append(e),r.scrollTop(r[0].scrollHeight),o.current===o.totalCalls||a.data.force_complete?(r.append(vgse_editor_settings.texts.import_finished),r.scrollTop(r[0].scrollHeight),i.go(100),p.find("#be-import-nanobar-container").remove(),p.find(".remodal-cancel").show(),p.find(".view-log a").attr("href")&&p.find(".view-log").show(),p.find(".import-actions").hide(),vgseReloadSpreadsheet(!0),!1):(i.go(o.current/o.totalCalls*100),p.find(".remodal-cancel").hide(),p.find(".view-log").hide(),p.find(".import-actions").show(),!0)},onError:function(e,t,a){if(++d<=3)var o=!!v.find(".auto-retry-failed-batches").is(":checked")||confirm(vgse_editor_settings.texts.import_failed_retry_server_error);else o=!1;return o?(window.vgseDontNotifyServerError=!0,a.current--,i.go(a.current/a.totalCalls*100),p.find(".remodal-cancel").hide(),p.find(".view-log").hide(),p.find(".import-actions").show(),!0):(r.append(vgse_editor_settings.texts.import_failed_server_error_tips),r.scrollTop(r[0].scrollHeight),i.go(100),p.find("#be-import-nanobar-container").remove(),p.find(".remodal-cancel").show(),p.find(".view-log a").attr("href")&&p.find(".view-log").show(),p.find(".import-actions").hide(),!1)}}),p.find(".pause-import").data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause'),!1}),p.find(".pause-import").on("click",function(e){e.preventDefault();var t=jQuery(this);"pause"===t.data("action")?(t.data("action","play").addClass("button-primary").removeClass("button-secondary").html('<i class="fa fa-play"></i> Resume'),window.beImportLoop.pause(),p.find(".remodal-cancel").show(),p.find(".remodal-confirm").show()):(t.data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause'),window.beImportLoop.resume(),p.find(".remodal-cancel").hide(),p.find(".view-log").hide(),p.find(".remodal-confirm").hide())})}),jQuery(document).ready(function(){var c;if(!(c=jQuery(".export-csv-form")).length)return!0;(c=jQuery(".export-csv-form")).find(".export-actions").hide(),c.find(".select-all").on("click",function(e){e.preventDefault(),c.find(".export-columns option").prop("selected",!0).trigger("change")}),c.find(".select-active").on("click",function(e){e.preventDefault();var t=c.find(".export-columns"),o=[];jQuery.each(vgse_editor_settings.columnsFormat,function(e,t){var a=vgseColumnKeyToExportKey(e);o.push(a)}),t.find("option").prop("selected",!1),o.forEach(function(e){t.find('option[value="'+e+'"]').prop("selected",!0)}),t.trigger("change")}),c.find(".unselect-all").on("click",function(e){e.preventDefault(),c.find(".export-columns option").prop("selected",!1).trigger("change")}),c.on("submit",function(e){if(c.find('[name="schedule_for_later"]').prop("checked"))return!0;window.beExportLoop=null;var t=vgseGetSelectedRowsCount(c);if("selected"===c.find(".wpse-select-rows-options").val()){var a=vgseGetSelectedIds();if(t=a.length){var o=beGetRowsFilters();beAddRowsFilter("post__in="+a.join(","))}}if(!vgseGetSelectedRowsCount(c))return alert(vgse_editor_settings.texts.no_rows_for_export),!1;var n=c.find(".export-response");n.empty(),c.find("#be-export-nanobar-container").remove(),n.before('<div id="be-export-nanobar-container" />');var r={classname:"be-progress-bar",target:document.getElementById("be-export-nanobar-container")},i=vgse_editor_settings.export_page_size,s={action:"vgse_load_data",vgse_plain_mode:"yes",posts_per_page:i,vgse_csv_export:"yes",custom_enabled_columns:c.find(".export-columns").val().join(","),line_items_separate_rows:c.find(".wpse_line_items_separate_rows").prop("checked")||0,add_excel_separator_flag:c.find(".excel-compatibility-container select").val()?1:0,nonce:jQuery("#vgse-wrapper").data("nonce"),post_type:jQuery("#post-data").data("post-type"),filters:beGetRowsFilters(),wpse_job_id:[vgseFormatDate(),jQuery("#post-data").data("post-type"),vgseGuidGenerator()].join("-"),wpse_source_suffix:vgse_editor_settings.wpse_source_suffix||""};if(c.find('[name="save_for_later_name"]').val()){s.save_for_later={name:c.find('[name="save_for_later_name"]').val(),columns:s.custom_enabled_columns,add_excel_separator_flag:s.add_excel_separator_flag,filters:s.filters,post_type:s.post_type};var d=jQuery(".export_csv-container");d.find(".toolbar-submenu").length||d.append('<div class="toolbar-submenu" />');var l=d.find(".toolbar-submenu").length;d.find(".toolbar-submenu .button:contains("+s.save_for_later.name+")").parent().remove(),d.find(".toolbar-submenu").append('<div class="button-container save_export-container"><button name="save_export'+l+'" class="button" data-start-saved-export>'+s.save_for_later.name+"</button></div>"),d.find(".toolbar-submenu").find(".button").last().data("start-saved-export",s.save_for_later)}var p=new Nanobar(r);return p.go(1),c.find(".remodal-cancel").hide(),c.find(".remodal-confirm").hide(),c.find(".export-actions").show(),c.find(".export-columns").prop("disabled",!0).trigger("change"),window.beExportLoop=beAjaxLoop({totalCalls:Math.ceil(t/i),url:vgse_editor_settings.ajax_url,dataType:"json",method:"POST",data:s,prepareData:function(e,t){return e.paged=e.page,e},onSuccess:function(e,t){return e.success?(t.totalCalls=Math.ceil(parseInt(e.data.total)/i),n.empty(),n.append(e.data.message),n.scrollTop(n[0].scrollHeight),t.current===t.totalCalls?(e.data.export_file_url&&window.location.href.indexOf("no_redirect=1")<0&&(window.location.href=e.data.export_file_url),n.scrollTop(n[0].scrollHeight),p.go(100),c.find("#be-export-nanobar-container").remove(),c.find(".export-actions").hide(),c.find(".remodal-cancel").show(),c.find(".remodal-confirm").show(),c.find(".export-columns").prop("disabled",!1).trigger("change"),void 0!==o&&beAddRowsFilter("post__in="),!1):(p.go(t.current/t.totalCalls*100),c.find(".remodal-cancel").hide(),!0)):(n.append("<p>"+e.data.message+"</p>"),n.scrollTop(n[0].scrollHeight),p.go(100),c.find("#be-export-nanobar-container").remove(),c.find(".remodal-cancel").show(),c.find(".remodal-confirm").show(),c.find(".export-columns").prop("disabled",!1).trigger("change"),!1)},onError:function(e,t,a){return 30<i&&(500<=e.status||"timeout"===t)?(window.vgseDontNotifyServerError=!0,i=10,a.data.posts_per_page=i,a.current=0,c.find(".remodal-cancel").hide(),!0):confirm(vgse_editor_settings.texts.formula_retry_batch)?(window.vgseDontNotifyServerError=!0,a.current--,p.go(a.current/a.totalCalls*100),c.find(".remodal-cancel").hide(),!0):(n.append(vgse_editor_settings.texts.process_execution_failed),n.scrollTop(n[0].scrollHeight),p.go(100),c.find("#be-export-nanobar-container").remove(),c.find(".remodal-cancel").show(),c.find(".remodal-confirm").show(),c.find(".export-columns").prop("disabled",!1).trigger("change"),void 0!==o&&beAddRowsFilter("post__in="),!1)}}),c.find(".pause-export").data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause'),!1}),c.find(".pause-export").on("click",function(e){e.preventDefault();var t=jQuery(this);"pause"===t.data("action")?(t.data("action","play").addClass("button-primary").removeClass("button-secondary").html('<i class="fa fa-play"></i> Resume'),window.beExportLoop.pause(),c.find(".remodal-cancel").show(),c.find(".remodal-confirm").show(),c.find(".export-columns").prop("disabled",!1).trigger("change"),c.find(".export-actions").show()):(t.data("action","pause").addClass("button-secondary").removeClass("button-primary").html('<i class="fa fa-pause"></i> Pause'),window.beExportLoop.resume(),c.find(".remodal-cancel").hide(),c.find(".remodal-confirm").hide())}),c.find(".export-columns").on("change",function(){window.beExportLoop&&(window.beExportLoop.pause(),c.find(".export-actions").hide())})}),jQuery(document).ready(function(){var o=jQuery('[data-remodal-id="export-csv-modal"]');jQuery("body").on("click","[data-start-saved-export]",function(e){e.preventDefault();var t=jQuery(this).data("start-saved-export");o.remodal().open();var a=o.find(".export-columns");a.find("option").prop("selected",!1),t.columns.split(",").forEach(function(e){a.find('option[value="'+e+'"]').prop("selected",!0)}),a.trigger("change"),o.find(".excel-compatibility-container select").val(t.add_excel_separator_flag?"yes":""),jQuery("body").data("be-filters",""),beAddRowsFilter(t.filters),o.find('[name="save_for_later_name"]').val(""),o.find(".export-rows").val("list"),o.find(".vgse-trigger-export").click()}),jQuery(document).on("opened",".export-csv-modal",function(){vgse_editor_settings.disable_automatic_loading_rows&&0===hot.countRows()&&setTimeout(function(){jQuery("#vgse-wrapper button[name=load]").click()},400);var t=jQuery(".export-columns"),o=[];jQuery.each(vgse_editor_settings.columnsFormat,function(e,t){var a=vgseColumnKeyToExportKey(e);o.push(a)});o=o.filter(function(e,t,a){return a.indexOf(e)==t});var e=t.find("option"),a=[],n=[];e.each(function(){-1<o.indexOf(jQuery(this).val())?a["key"+jQuery(this).val()]=jQuery(this):n.push(jQuery(this))}),t.find("option").remove(),o.forEach(function(e){t.append(a["key"+e])}),n.forEach(function(e){t.append(e)}),t.data("wpse-sort-fixed")||t.select2().on("select2:select",function(a){if("string"==typeof(e=a.params.data.id))var e=[e];e.forEach(function(e){var t=jQuery(a.target).children('[value="'+e+'"]');jQuery(a.target).append(t)}),jQuery(a.target).trigger("change"),t.data("wpse-sort-fixed",1)});var r=jQuery(".export-csv-modal"),i=vgseGetSelectedIds(),s=r.find('.wpse-select-rows-options option[value="selected"]'),d=r.find('.wpse-select-rows-options option[value="current_search"]');s.text(s.text().replace(/ \(\d+\)/,"")+" ("+i.length+")"),d.text(d.text().replace(/ \(\d+\)/,"")+" ("+window.beFoundRows+")"),r.find(".export-response").empty()})}),jQuery(window).on("load",function(){jQuery("body").on("click",".wpse-quick-access-link",function(e){e.preventDefault();var t=jQuery(this);"function"==typeof loading_ajax&&loading_ajax({estado:!0}),jQuery.get(vgse_universal_sheet_data.rest_base_url+"sheet-editor/v1/sheet/generate-quick-access?_wpnonce="+vgse_universal_sheet_data.rest_nonce+"&sheet_key="+vgse_universal_sheet_data.post_type,function(e){t.parent().find(".wpsegs-quick-access input").val(e.quick_access_url).focus(),t.parent().find(".wpsegs-quick-access").show(),"function"==typeof loading_ajax&&loading_ajax({estado:!1})})})}),jQuery(document).ready(function(){var o=jQuery('[data-remodal-id="export-csv-modal"]');if("undefined"==typeof hot||!o.length)return!0;var e=hot.getSettings().contextMenu;void 0===e.items&&(e.items={}),e.items.wpse_export_column={name:vgse_editor_settings.texts.export_column,hidden:function(){if(!hot.getSelected())return!0;var e=hot.colToProp(hot.getSelected()[0][1]);return!(o.find(".export-columns").find('option[value="'+e+'"]').length||vgse_editor_settings.export_keys_mapping&&vgse_editor_settings.export_keys_mapping[e])},callback:function(e,t,a){var r=o.find(".export-columns");r.find("option").toArray().forEach(function(e){jQuery(e).prop("selected",!1)}),t.forEach(function(e){for(var t=e.start.col>e.end.col?e.end.col:e.start.col,a=e.start.col>e.end.col?e.start.col:e.end.col,o=[],n=t;n<=a;n++)o.push(n);o.forEach(function(e){var t=vgseColumnKeyToExportKey(hot.colToProp(e));r.find('option[value="'+t+'"]').prop("selected",!0)})}),o.remodal().open(),r.find('option[value="'+vgseColumnKeyToExportKey(hot.colToProp(1))+'"]').prop("selected",!0),r.trigger("change"),o.find(".export-rows").val("list"),o.find(".vgse-trigger-export").click()}},hot.updateSettings({contextMenu:e})});